---
title: "trend"
output: rmarkdown::github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```

## trend analysis

```{r stroke14} ```{r stroke15}

library(tidyverse)

stroke <- read.csv("stroke.csv")
stroke_sexo <- subset(stroke, select = c(year,sexo)) 
stroke_s1 <- stroke_sexo %>%
  group_by(year) %>%
  summarise(total = n()) 

strokefemale <- subset(stroke, stroke$sexo=="Women", select = c(year))
strokefemale <- strokefemale%>%group_by(year)%>%dplyr::summarise(women = n())
strokemale <- subset(stroke, stroke$sexo=="Men", select = c(year))
strokemale <- strokemale%>%group_by(year)%>%dplyr::summarise(men = n())

stroketrendsex <- full_join(stroke_s1,strokefemale)
stroketrendsex <- full_join(stroketrendsex, strokemale)
stroketrendsex <- stroketrendsex %>% 
  mutate(percent1=women/total) %>% 
  mutate(percent2=men/total)

stroke14 <- stroketrendsex %>% filter(year %in% c("2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012","2013","2014"))
stroke14$percent1 <- as.ts(stroke14$percent1)
stroke14$percent2 <- as.ts(stroke14$percent2)

stroke15 <- stroketrendsex %>% filter(year %in% c("2015","2016","2017"))
stroke15$percent1 <- as.ts(stroke15$percent1)
stroke15$percent2 <- as.ts(stroke15$percent2)

stroke14
stroke15
```

##  Trend test

```{r , echo=FALSE}

library(trend)
partial.cor.trend.test(stroke14$percent1,stroke14$percent2, method = "spearman")
partial.cor.trend.test(stroke15$percent1,stroke15$percent2, method = "spearman")
```
